name: Etsi16                            #Model name
description: etsi 16                    #Model description
version: 1.0                            #Model version
designer: Pierluigi Greto               #Model designer
nodes:                                  #List of nodes, with id and label used in the gui (We can add more fields)
    vnf:
        label: VNF
    ns_vl:
        label: VL
    ns_cp:
        label: SAP
    vnf_vl:
        label: intVL
    vnf_vdu:
        label: VduCP
    vnf_exp_cp:
        label: ExtCP
    vnf_vdu_cp:
        label: VDU
layer:                                  #List of Layers
    ns:
        nodes:                  #List of node to be visualized in the current layer
            vnf:
                addable:
                    callback: addVnf
                expands : vnf
            ns_vl:
                addable:
                    callback: addNode
            ns_cp:
                addable:
                    callback: addNode
        allowed_edges:                  #List of allowed edges between the layer's nodes
            vnf:                        #Edge's source
                destination:            #List of edge's destination with the list of controls callback id to call when there is a connections
                    ns_vl:
                        callback:
                            -   chooseVnfExp
                        direct_edge: false
                    ns_cp:
                        callback:
                            -   nsCpExclusiveConnection
                            -   chooseVnfExp
                        direct_edge: false
            ns_vl:
                destination:
                    vnf:
                        callback:
                            -   chooseVnfExp
                        direct_edge: false
                    ns_cp:
                        callback:
                            -   nsCpExclusiveConnection
                        direct_edge: false

            ns_cp:
                destination:
                    vnf:
                        callback:
                            -   nsCpExclusiveConnection
                            -   chooseVnfExp
                        direct_edge: false
                    ns_vl:
                        callback:
                            -   nsCpExclusiveConnection
                        direct_edge: false

    vnf:
        nodes:
            vnf_vl:
              addable:
                callback: addNode
            vnf_vdu:
              addable:
                callback: addVnfVdu
            vnf_ext_cp:
              addable:
                callback: addNode
            vnf_vdu_cp:
              addable:
                callback: addVnfVduCp
        allowed_edges:
            vnf_vl:
                destination:
                    vnf_vdu_cp:
                        callback:
                            -   getVduConnectedToVduCp
                        direct_edge: false
                    vnf_exp_cp:
                        direct_edge: false
            vnf_vdu:
                destination:
                    vnf_vdu_cp:
                        direct_edge: false
            vnf_exp_cp:
                destination:
                    vnf_vl:
                        direct_edge: false
                    vnf_vdu_cp:
                        callback:
                            -   getVduConnectedToVduCp
                        direct_edge: false
            vnf_vdu_cp:
                destination:
                    vnf_vdu:
                        direct_edge: false
                    vnf_exp_cp:
                        direct_edge: false


callback:                             #List of callbacks used to controll the link
  chooseVnfExp:                       #Choose the VnfExp of the vnf with id vnf_id
      file: etsi_controller.js
      class: EtsiController
#      function_name: chooseVnfExp
#      argument:
#          -   vnf_id
  nsCpExclusiveConnection:            #Check if the ns_cp with ns_cp_id id has not other connection
      file: etsi_controller.js
      class: EtsiController
 #     function_name: chooseVnfExp
 #     argument:
 #         -   ns_cp_id
  getVduConnectedToVduCp:             #Return the vnf_vdu if connected to the vnf_vdu_cp
      file: etsi_controller.js
      class: EtsiController
  #    function_name: getVduConnectedToVduCp
  #    argument:
  #        -   vnf_vdu_cp
  addVnf:             #Return the vnf_vdu if connected to the vnf_vdu_cp
    file: etsi_controller.js
    class: EtsiController
  #    function_name: getVduConnectedToVduCp
  #    argument:
  #        -   vnf_vdu_cp
  addNode:             #Return the vnf_vdu if connected to the vnf_vdu_cp
    file: etsi_controller.js
    class: EtsiController
  #    function_name: getVduConnectedToVduCp
  #    argument:
  #        -   vnf_vdu_cp

  addVnfVdu:             #Return the vnf_vdu if connected to the vnf_vdu_cp
    file: etsi_controller.js
    class: EtsiController
  #    function_name: getVduConnectedToVduCp
  #    argument:
  #        -   vnf_vdu_cp
  addVnfVduCp:             #Return the vnf_vdu if connected to the vnf_vdu_cp
    file: etsi_controller.js
    class: EtsiController
  #    function_name: getVduConnectedToVduCp
  #    argument:
  #        -   vnf_vdu_cp